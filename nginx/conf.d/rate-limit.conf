# Orizon Zero Trust Connect - Rate Limiting
# Copy to /etc/nginx/conf.d/rate-limit.conf
#
# Usage in server block:
#   location /api/ {
#       limit_req zone=api burst=20 nodelay;
#       ...
#   }
#   location /api/v1/auth/login {
#       limit_req zone=login burst=5 nodelay;
#       ...
#   }

# API rate limit: 10 requests/second per IP
limit_req_zone $binary_remote_addr zone=api:10m rate=10r/s;

# Login rate limit: 3 requests/second per IP (stricter for auth)
limit_req_zone $binary_remote_addr zone=login:10m rate=3r/s;

# WebSocket connections: 5 per second per IP
limit_req_zone $binary_remote_addr zone=websocket:10m rate=5r/s;

# General connections limit
limit_conn_zone $binary_remote_addr zone=conn:10m;

# Custom error page for rate limiting
# limit_req_status 429;
